<!doctype html>
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta name="keywords" content="亿栖云">

<meta name="generator" content="Hugo 0.101.0" />

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">



<link rel="icon" href="http://yiqiyun.sd.cegn.cn/static/assets/images/favicon.ico?v=1632342842" type="image/x-icon">

<title>Virtual SAN | 亿栖云文档</title>

<link href="/css/bulma.css" rel="stylesheet">
<link href="/css/autocomplete.css" rel="stylesheet" />
<link href="/css/copy-to-clipboard.css" rel="stylesheet" />


    



<link rel="preload" href="/scss/console.min.3968935d0a1c8815d0609e047c8c7bddc7781a37538ed1b0cc049f82a7c994c1.css" as="style">
<link href="/scss/console.min.3968935d0a1c8815d0609e047c8c7bddc7781a37538ed1b0cc049f82a7c994c1.css" rel="stylesheet" integrity="">


<script
  src="/js/jquery-2.2.4.js?v=1510299508"
  ></script>
	

<script src="/js/common.js?v=1.3"></script>

  </head>
  <body class="td-page">
    <header>
      <div class="nav-wrapper ">
  <nav class="navbar navmenu"  style="display:none;" >
    <div class="container with-no-position doc-container-width ">
      <div class="navbar-brand" id="search-mobile-logo">
        <a class="navbar-item logo" href="http://www.yiqiyun.net.cn">
          <img src="/images/yiqiyun_logo.png" alt="logo" style="height: 32px;width: 120px;">
        </a>
      </div>
      <div class="media-content column is-centered is-5 search-mobile">
        <form action="/search" method="GET">
          <div class="control has-icons-right docs-search-input">
            <input class="input" id="search-bar" name="q" type="search" placeholder="搜索" autocomplete="off">
            <span class="icon is-right" id="mobile-search">
              <img src="/images/icons/search.svg">
            </span>
          </div>
        </form>
        <a href="javascript:;" class="search-mobile-icon"><img src="/images/icons/search.svg"></a>
      </div>
      <div class="navbar-end is-hidden-mobile header-account">
        <div class="navbar-item">
          <div class="field is-grouped">
            <p class="control navbar-user">
              <a class="nav-item" href="http://www.yiqiyun.cn">服务商门户</a>
            </p>
            <p class="control navbar-user">
              <a class="nav-item" href="http://console.yiqiyun.cn/login">登录</a>
            </p>
            <div class="navbar-user">
              <a class="button is-primary j-signup" href="http://console.yiqiyun.cn/signup/" data-gio="{id:'createPageView',var:{sourceType_var:'导航栏'}}" style="background-color: #55a8fd">注册</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>
  
  <nav class="navbar navmenu navbar-index">
    <div class="container is-size-7 doc-container-width " data-path="1">


	
	
		

  
  

  
  

  
  

  


	
	




  


	
	
	<a href="/storage/share/" class="has-text-primary">共享存储</a><img class="container_span_space" src="/images/icons/path.svg">
	




  


	
	
	<a href="" class="has-text-primary">操作指南</a><img class="container_span_space" src="/images/icons/path.svg">
	




  



	
	<span class="crumb-last-color">Virtual SAN</span>
	



	

</div>


  </nav>
  
</div>
    </header>
    <div class="container td-outer doc-container-width container-min-height">
      <div class="td-main">
		
			<h1 class="console-tree-title">操作指南</h1>
		
        <div class="row flex-xl-nowrap">
		  
          <div class="col-12 col-md-3 col-xl-3 td-sidebar d-print-none td-sidebar-menu">
            





<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <nav class="collapse td-sidebar-nav pt-2" id="td-section-nav">
    <div class="nav-item dropdown d-block ">
      
      
      













<span class="menu__title--collapse  display-hide"
  data-depth="0">
  对象存储
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/object-storage/ data-link=/storage/share/manual/vsan/>
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  动态与公告
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/news/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/news/history/"
      class="menu__title  "
      data-depth="1">产品动态</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  产品简介
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/intro/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/intro/object-storage/"
      class="menu__title  "
      data-depth="1">对象存储</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/intro/function_list/"
      class="menu__title  "
      data-depth="1">功能概览</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  计费指南
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/billing/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/billing/price/"
      class="menu__title  "
      data-depth="1">消费说明</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse active "
  data-depth="1">
  操作指南
  <span
    class="menu__title--icon down">

  </span>
</span>
<ul class="menu__list active"
  data-data=/manual/ data-link=/storage/share/manual/vsan/>
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  Console
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/console/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/overview/"
      class="menu__title  "
      data-depth="2">概述</a>
  </li>
  
  
  
  













<span class="menu__title--collapse  "
  data-depth="3">
  Bucket 管理
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/bucket_manage/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/bucket_manage/basic_opt/"
      class="menu__title  "
      data-depth="3">基础操作</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/bucket_manage/access_control/"
      class="menu__title  "
      data-depth="3">访问控制</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/bucket_manage/monitor/"
      class="menu__title  "
      data-depth="3">监控与报表</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/bucket_manage/logging/"
      class="menu__title  "
      data-depth="3">日志归档</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/bucket_manage/lifecycle/"
      class="menu__title  "
      data-depth="3">生命周期管理</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/bucket_manage/replication/"
      class="menu__title  "
      data-depth="3">跨区域复制</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="3">
  Object 管理
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/object_manage/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/object_manage/basic_opt/"
      class="menu__title  "
      data-depth="3">基础操作</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/object_manage/change_level/"
      class="menu__title  "
      data-depth="3">变更存储级别</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/object_manage/modify_meta/"
      class="menu__title  "
      data-depth="3">修改元数据</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="3">
  数据处理
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/data_process/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/console/data_process/image_process/"
      class="menu__title  "
      data-depth="3">图片处理</a>
  </li>
  
  
</ul>


  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  客户端工具
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/tool/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/tool/qsctl/"
      class="menu__title  "
      data-depth="2">qsctl</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/tool/qscamel/"
      class="menu__title  "
      data-depth="2">qscamel</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/tool/qsftpd/"
      class="menu__title  "
      data-depth="2">qsftpd</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/tool/mountain-duck/"
      class="menu__title  "
      data-depth="2">Mountain Duck</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  第三方数据集成
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/third_party_integration/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/third_party_integration/logstash_input/"
      class="menu__title  "
      data-depth="2">Logstash Input QingStor</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/third_party_integration/logstash_output/"
      class="menu__title  "
      data-depth="2">Logstash Output QingStor</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/manual/third_party_integration/wordpress_plugin_for_qingstor/"
      class="menu__title  "
      data-depth="2">WordPress QingStor </a>
  </li>
  
  
</ul>


  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  最佳实践
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/beat-practices/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/beat-practices/migrate/"
      class="menu__title  "
      data-depth="1">数据迁移方案</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/beat-practices/backup/"
      class="menu__title  "
      data-depth="1">实时增量数据备份解决方案</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/beat-practices/app_integration/"
      class="menu__title  "
      data-depth="1">移动 App 接入方案</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/beat-practices/linux_uses_object_storage_as_a_local_disk/"
      class="menu__title  "
      data-depth="1">Linux 使用对象存储作为本地盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/beat-practices/web_hosting/"
      class="menu__title  "
      data-depth="1">静态网站托管方案</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/beat-practices/policy/"
      class="menu__title  "
      data-depth="1">Bucket Policy 白名单和黑名单使用实例</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  API 参考
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/api/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/overview/"
      class="menu__title  "
      data-depth="1">概述</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/common_header/"
      class="menu__title  "
      data-depth="1">公共字段</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/metadata/"
      class="menu__title  "
      data-depth="1">对象元数据</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/error_code/"
      class="menu__title  "
      data-depth="1">错误信息</a>
  </li>
  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  Bucket API
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/bucket/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/policy/"
      class="menu__title  "
      data-depth="2">Bucket 策略（Policy）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/basic_opt/"
      class="menu__title  "
      data-depth="2">基础操作</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/repliation/"
      class="menu__title  "
      data-depth="2">跨区域复制（Replication）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/cors/"
      class="menu__title  "
      data-depth="2">跨域资源共享（CORS）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/acl/"
      class="menu__title  "
      data-depth="2">权限控制（ACL）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/logging/"
      class="menu__title  "
      data-depth="2">日志管理（Logging）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/lifecycle/"
      class="menu__title  "
      data-depth="2">生命周期（Lifecycle）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/notification/"
      class="menu__title  "
      data-depth="2">事件通知（Notification）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/external_mirror/"
      class="menu__title  "
      data-depth="2">外部镜像（External Mirror）</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/bucket/cname/"
      class="menu__title  "
      data-depth="2">自定义域名（CNAME）</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  Object API
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/object/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/object/append/"
      class="menu__title  "
      data-depth="2">Append Object</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/object/multipart/"
      class="menu__title  "
      data-depth="2">Multipart 分段</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/object/post/"
      class="menu__title  "
      data-depth="2">Post Object</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/object/basic_opt/"
      class="menu__title  "
      data-depth="2">基础操作</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/object/encryption/"
      class="menu__title  "
      data-depth="2">数据加密</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/object/image_process/"
      class="menu__title  "
      data-depth="2">图片处理</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  Service API
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/service/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/service/get/"
      class="menu__title  "
      data-depth="2">GET Service</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/service/location/"
      class="menu__title  "
      data-depth="2">List Locations</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  API 使用示例
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/practices/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/practices/access_control/"
      class="menu__title  "
      data-depth="2">访问控制</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/api/practices/signature/"
      class="menu__title  "
      data-depth="2">签名验证</a>
  </li>
  
  
</ul>


  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  常见问题
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/faq/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/faq/object-faq/"
      class="menu__title  "
      data-depth="1">FAQ</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  AWS S3 兼容
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/s3/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/s3/s3_browser/"
      class="menu__title  "
      data-depth="1">安装 S3 Browser</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/s3/compatible_headers/"
      class="menu__title  "
      data-depth="1">兼容公共头</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/s3/compatible_apis/"
      class="menu__title  "
      data-depth="1">兼容接口</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/s3/examples/"
      class="menu__title  "
      data-depth="1">使用示例</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  SDK
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/sdk/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/sdk/python/"
      class="menu__title  "
      data-depth="1">Python SDK</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/sdk/go/"
      class="menu__title  "
      data-depth="1">Go SDK</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/sdk/ruby/"
      class="menu__title  "
      data-depth="1">Ruby SDK</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/sdk/cpp/"
      class="menu__title  "
      data-depth="1">C/C&#43;&#43; SDK</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/sdk/java/"
      class="menu__title  "
      data-depth="1">Java SDK</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/sdk/javascript/"
      class="menu__title  "
      data-depth="1">JavaScript SDK</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/object-storage/sdk/php/"
      class="menu__title  "
      data-depth="1">PHP SDK</a>
  </li>
  
  
</ul>


  
  
</ul>


      
      













<span class="menu__title--collapse  display-hide"
  data-depth="0">
  硬盘
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/disk/ data-link=/storage/share/manual/vsan/>
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  动态与公告
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/news/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/news/product_news/"
      class="menu__title  "
      data-depth="1">产品动态</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  产品简介
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/intro/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/intro/introduction/"
      class="menu__title  "
      data-depth="1">硬盘简介</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  计费指南
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/billing/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/billing/price/"
      class="menu__title  "
      data-depth="1">硬盘计费</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  快速入门
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/quickstart/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/quickstart/create_disk/"
      class="menu__title  "
      data-depth="1">步骤1：购买硬盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/disk/quickstart/load/"
      class="menu__title  "
      data-depth="1">步骤2：加载硬盘</a>
  </li>
  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  步骤3：初始化硬盘
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/init/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/quickstart/init/init_start/"
      class="menu__title  "
      data-depth="2">初始化及分区方式</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/disk/quickstart/init/init_linux/"
      class="menu__title  "
      data-depth="2">初始化 Linux 数据盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/disk/quickstart/init/init_win/"
      class="menu__title  "
      data-depth="2">初始化 Windows 数据盘</a>
  </li>
  
  
</ul>


  
  
</ul>


  
  
  
  













<span class="menu__title--collapse active "
  data-depth="1">
  操作指南
  <span
    class="menu__title--icon down">

  </span>
</span>
<ul class="menu__list active"
  data-data=/manual/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/basic_operation/"
      class="menu__title  "
      data-depth="1">硬盘基本操作</a>
  </li>
  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  硬盘扩容
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/expand/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/expand/expan_linux/"
      class="menu__title  "
      data-depth="2">扩容 Linux 数据盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/expand/expan_win/"
      class="menu__title  "
      data-depth="2">扩容 Windows 数据盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/expand/expan_linux_sys/"
      class="menu__title  "
      data-depth="2">扩容系统盘</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse  "
  data-depth="2">
  配置自动挂载
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/auto_mount/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/auto_mount/linux_auto_mount/"
      class="menu__title  "
      data-depth="2">自动挂载 Linux 硬盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/auto_mount/win_auto_mount/"
      class="menu__title  "
      data-depth="2">自动挂载 Windows 硬盘</a>
  </li>
  
  
</ul>


  
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/create_snapshot/"
      class="menu__title  "
      data-depth="1">备份硬盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/disk/manual/unload/"
      class="menu__title  "
      data-depth="1">卸载硬盘</a>
  </li>
  
  
</ul>


  
  
</ul>


      
      













<span class="menu__title--collapse active display-hide"
  data-depth="0">
  共享存储
  <span
    class="menu__title--icon down">

  </span>
</span>
<ul class="menu__list active"
  data-data=/share/ data-link=/storage/share/manual/vsan/>
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  产品简介
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/intro/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/share/intro/introduction/"
      class="menu__title  "
      data-depth="1">共享存储</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse active "
  data-depth="1">
  操作指南
  <span
    class="menu__title--icon down">

  </span>
</span>
<ul class="menu__list active"
  data-data=/manual/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/share/manual/neonsan_volume/"
      class="menu__title  "
      data-depth="1">企业级分布式 SAN</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/share/manual/vsan/"
      class="menu__title active "
      data-depth="1">Virtual SAN</a>
  </li>
  
  
</ul>


  
  
</ul>


      
      













<span class="menu__title--collapse  display-hide"
  data-depth="0">
  备份
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/backup/ data-link=/storage/share/manual/vsan/>
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  产品简介
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/intro/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/backup/intro/introduction/"
      class="menu__title  "
      data-depth="1">备份概述</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse active "
  data-depth="1">
  操作指南
  <span
    class="menu__title--icon down">

  </span>
</span>
<ul class="menu__list active"
  data-data=/manual/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/backup/manual/create_snapshot/"
      class="menu__title  "
      data-depth="1">创建备份</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/backup/manual/delete_snapshot/"
      class="menu__title  "
      data-depth="1">删除备份</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/backup/manual/rollback_snapshot/"
      class="menu__title  "
      data-depth="1">备份回滚</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/backup/manual/bak_create_mirror/"
      class="menu__title  "
      data-depth="1">基于备份制作镜像</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/backup/manual/bak_create_disk/"
      class="menu__title  "
      data-depth="1">基于备份创建硬盘</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/backup/manual/backup/"
      class="menu__title  "
      data-depth="1">其他备份相关操作</a>
  </li>
  
  
</ul>


  
  
</ul>


      
      













<span class="menu__title--collapse  display-hide"
  data-depth="0">
  文件存储
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list  "
  data-data=/vnas/ data-link=/storage/share/manual/vsan/>
  
  
  













<span class="menu__title--collapse  "
  data-depth="1">
  产品简介
  <span
    class="menu__title--icon right">

  </span>
</span>
<ul class="menu__list "
  data-data=/intro/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/vnas/intro/introduction/"
      class="menu__title  "
      data-depth="1">Virtual NAS</a>
  </li>
  
  
</ul>


  
  
  
  













<span class="menu__title--collapse active "
  data-depth="1">
  操作指南
  <span
    class="menu__title--icon down">

  </span>
</span>
<ul class="menu__list active"
  data-data=/manual/ data-link=/storage/share/manual/vsan/>
  
  
  
  
  
  <li>
    <a href="/storage/vnas/manual/vnas_expansion/"
      class="menu__title  "
      data-depth="1">Virtual NAS 云硬盘扩容</a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/storage/vnas/manual/vnas/"
      class="menu__title  "
      data-depth="1">Virtual NAS</a>
  </li>
  
  
</ul>


  
  
</ul>


      
    </div>
  </nav>
</div>


<script src="/js/sidebar-tree.js"></script>


          </div>
          <div class="d-none col-md-2 d-xl-block d-md-block col-xl-2 td-toc d-print-none">
            


<h3 class="nav-title">本页目录</h3>


<nav id="TableOfContents">
  <ul>
    <li><a href="#创建-virtual-san-服务器">创建 Virtual SAN 服务器</a></li>
    <li><a href="#创建目标">创建目标</a></li>
    <li><a href="#配置-iscsi-客户端">配置 iSCSI 客户端</a>
      <ul>
        <li><a href="#linux">Linux</a></li>
        <li><a href="#windows">Windows</a></li>
      </ul>
    </li>
    <li><a href="#公网访问-virtual-san">公网访问 Virtual SAN</a></li>
    <li><a href="#部署-oracle-rac">部署 Oracle RAC</a>
      <ul>
        <li><a href="#oracle-rac-部署拓扑">Oracle RAC 部署拓扑</a></li>
        <li><a href="#安装前准备">安装前准备</a></li>
        <li><a href="#网络配置">网络配置</a></li>
        <li><a href="#创建用户修改用户配置文件">创建用户、修改用户配置文件</a></li>
        <li><a href="#存储配置">存储配置</a></li>
        <li><a href="#安装-oracle-软件">安装 Oracle 软件</a></li>
      </ul>
    </li>
  </ul>
</nav>




          </div>
          <main class="col-12 col-md-7 col-xl-7" role="main">
            
  

            
            
            
<div class="td-content">
	<div class="td-sidebar-section-title content-index">
		<img class="is-40x40" src="/images/icons/book-open.svg">
		<h3 class="doc_vice_title">操作指南</h3>
		<a href="javascript:;" class="nav-trigger">&nbsp;<span aria-hidden="true"></span></a>
	</div>
	<div class="td-page-top">
		<h1>Virtual SAN</h1>
		






<div class="td-page-meta page-meta-actions ml-2 pb-1 mb-0">







</div>



	</div>
	<div class="page-meta-lastmod text-muted ">
	更新时间 2020-01-30

</div>

	<input type="hidden" id="content_console" value="1">
	
	
	<div class="lead"></div>
	

	
	<h1 id="简介">简介</h1>
<p>通过亿栖云的 SDS（软件定义存储）技术，您可以快速地搭建您专属的基于 iSCSI 协议的 Virtual SAN 服务。 首先需要创建一个 Virtual SAN 服务器；然后再在其上创建一个或多个目标； 最后在云服务器客户端登录这些目标即可使用。</p>
<p>本指南旨在介绍如何配置 Virtual SAN 和目标，以及如何设置客户端来访问 Virtual SAN。</p>
<blockquote>
<p>注解</p>
<p>如果将一块硬盘通过 Virtual SAN 服务挂载到多台云服务器上，那么必须通过分布式文件系统（Distributed File System）的支持才可以并行读写，可以使用亿栖云已经推出的 NAS 服务。</p>
</blockquote>
<h2 id="创建-virtual-san-服务器">创建 Virtual SAN 服务器</h2>
<p><strong>操作步骤如下：</strong></p>
<ol>
<li>
<p>在控制台导航中点击 <strong>产品与服务</strong> &gt; <strong>存储服务</strong> &gt; <strong>共享存储</strong> &gt; <strong>Virtual SAN</strong> 进入列表页面。</p>
</li>
<li>
<p>点击<strong>创建</strong>按钮开始创建。进入如下页面：</p>
<p><img src="/storage/share/manual/_images/create_s2_server.png" alt=""></p>
</li>
<li>
<p>设置如下基本信息。</p>
</li>
</ol>
<table>
<thead>
<tr>
<th><div style="width: 50pt">参数名称</div></th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>名称</td>
<td>Virtual SAN 服务器的名称。</td>
</tr>
<tr>
<td>类型</td>
<td>支持性能型和超高性能型。 <li>性能型 VSAN 服务使用的云服务器类型为基础型的云服务器，是面向个人或中小团队用户推出的入门型共享块存储服务，满足低负载的共享存储服务的场景需求。性能型 VSAN 服务可以使用基础型硬盘，容量型硬盘和企业级分布式 SAN 硬盘 (NeonSAN) 。</li><li>超高性能型 VSAN 服务使用的云服务器类型为企业型的云服务器，是面向性能要求更高的的企业级生产应用环境设计的高性能高可靠共享块存储服务，满足企业客户关键业务使用场景的存储需求。超高性能型 VSAN 服务可以使用 SSD 企业型硬盘，容量型硬盘和企业级分布式 SAN 硬盘 (NeonSAN) 。</li></td>
</tr>
<tr>
<td>VPC网络</td>
<td>根据实际情况选择。如需创建新的VPC网络，点击<strong>新建VPC网络</strong>，即可跳转至相应页面进行创建。</td>
</tr>
<tr>
<td>私有网络</td>
<td>根据实际情况选择。如需创建新的私有网络，点击<strong>新建私有网络</strong>，即可跳转至相应页面进行创建。 <div style="background-color: #D8ECDE; padding: 10px 24px; margin: 10px 0; border-left: 3px solid #00a971;"><b>说明</b>：<br>需要确保所选私有网络的 DHCP 处于<strong>打开</strong>状态。</div></td>
</tr>
<tr>
<td>可用区</td>
<td>根据实际情况选择。</td>
</tr>
<tr>
<td>工作模式</td>
<td>支持单节点和集群。 <br /> 集群模式可用于客户端 HA 和负载均衡，目前共享目标硬盘仅支持企业级分布式 SAN（NeonSAN）。</td>
</tr>
<tr>
<td>节点数量</td>
<td>工作模式设置为<strong>集群</strong>时需设置该参数。根据实际情况设置。支持范围为：2~10。</td>
</tr>
<tr>
<td>IP</td>
<td>支持自动分配和手动指定。根据实际情况设置。</td>
</tr>
</tbody>
</table>
<h2 id="创建目标">创建目标</h2>
<p><strong>操作步骤如下：</strong></p>
<ol>
<li>点击创建成功的 Virtual SAN 服务器。 进入 Virtual SAN 服务器的详细信息页面，点击 <strong>创建目标门户组</strong>，进入如下界面。</li>
</ol>
<p><img src="/storage/share/manual/_images/create_s2_server_target.png" alt=""></p>
<table>
<thead>
<tr>
<th><div style="width: 50pt">参数名称</div></th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>目标类型</td>
<td>默认为iSCSI。</td>
</tr>
<tr>
<td>iSCSI标识</td>
<td>根据实际情况为目标指定 iSCSI 标识，也可以输入一个短名（中间不允许有空格，下划线等），亿栖云会自动帮您生成合法的 iSCSI 标识。<br /> 格式是：“iqn” + “.” + “年月” + “.” + “域名的颠倒” + “:” + “设备的具体名称”，颠倒域名是为了避免可能的冲突。</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>创建成功后，点击<strong>添加存储</strong>，进入如下界面。</li>
</ol>
<p><img src="../_images/create_s2_server_backstore.png" alt=""></p>
<ol start="3">
<li>
<p>添加 iSCSI 客户端（可选）。在Virtual SAN 服务器的详细信息页面，点击<strong>操作</strong> &gt; <strong>设置iSCSI客户端</strong>，进入如下界面。</p>
<p>为了 Virtual SAN 的安全性，可以指定 iSCSI 客户端登录到目标，即设置 iSCSI 客户端的 initiator name。</p>
</li>
</ol>
<p><img src="../_images/set_s2_server_initiators.png" alt=""></p>
<ol start="4">
<li>创建完成后，点击<strong>应用修改</strong>。Virtual SAN 服务端即设置完成。</li>
</ol>
<h2 id="配置-iscsi-客户端">配置 iSCSI 客户端</h2>
<p>该部分主要讲述如何在 Linux 和 Windows 两种操作系统上配置 iSCSI 客户端来访问 Virtual SAN。</p>
<h3 id="linux">Linux</h3>
<p><strong>安装客户端软件</strong></p>
<pre tabindex="0"><code>Redhat/Centos: yum install -y iscsi-initiator-utils
Debian/Ubuntu: apt-get install open-iscsi
</code></pre><p><strong>配置 initiator name</strong></p>
<p>编辑 <code>/etc/iscsi/initiatorname.iscsi</code>，加入 <code>InitiatorName</code>。 如果您在配置目标时设置了 iSCSI 客户端的 initiator name，请保证这两个名称一致，否则后面的登录操作会失败。</p>
<pre tabindex="0"><code>InitiatorName=iqn.1993-08.org.debian:01:967eaffe29d7
</code></pre><blockquote>
<p>注解</p>
<p>可以用 iscsi-iname 命令生成一个 initiator name，例如：</p>
</blockquote>
<pre tabindex="0"><code>iscsi-iname （以缺省前缀生成名称）
iscsi-iname -p iqn.2005-03.com.yiqiyun （以指定的前缀生成名称）
</code></pre><p><strong>发现目标</strong></p>
<p>默认情况下，iSCSI 发起方和目标方之间通过端口3260连接。</p>
<blockquote>
<p>注解</p>
<p>iSCSI 命令需要以 root 身份运行（下同）。</p>
</blockquote>
<pre tabindex="0"><code>iscsiadm -m discovery -t st -p &lt;Virtual SAN 服务器IP&gt;
iscsiadm -m node
</code></pre><p>iSCSI 发起方和目标方建立连接以后，可以进行登录节点操作。</p>
<p><strong>登录到目标</strong></p>
<pre tabindex="0"><code>iscsiadm -m node -T &lt;目标IQN&gt;  -p  &lt;Virtual SAN 服务器IP&gt;  --login
iscsiadm -m session
</code></pre><p>完成上述步骤后，当你执行 lsblk 命令时你可以发现本地多了一块或多块硬盘， 你可以像本地硬盘一样使用它（们）。</p>
<blockquote>
<p>注解</p>
<p>如果你想在客户端重启时自动登录，请执行下面的命令：</p>
</blockquote>
<pre tabindex="0"><code>iscsiadm -m node -T &lt;目标IQN&gt;  -p  &lt;Virtual SAN 服务器IP&gt; --op update -n node.startup -v automatic
</code></pre><p><strong>卸载、登出、删除目标</strong></p>
<pre tabindex="0"><code>umount /data (/data是共享存储挂载的目录)
iscsiadm -m node -T  &lt;目标IQN&gt;   -p &lt;Virtual SAN 服务器IP&gt; --logout
iscsiadm -m node -T &lt;目标IQN&gt; -p  &lt;Virtual SAN 服务器IP&gt; --op=delete
</code></pre><blockquote>
<p>注解</p>
<p>如果你想登出所有的目标，请执行下面的命令：</p>
</blockquote>
<pre tabindex="0"><code>iscsiadm -m node --logout
</code></pre><h3 id="windows">Windows</h3>
<p><strong>客户端软件</strong></p>
<p>在 Windows Server 2008 R2 中，可以通过执行以下操作之一访问 Microsoft iSCSI initiator 的界面：</p>
<ul>
<li>依次单击『开始』、『控制面板』和『经典视图』，然后单击 『iSCSI initiator』。</li>
<li>依次单击『开始』、『管理工具』，然后单击 『iSCSI initiator』。</li>
</ul>
<p>在 Windows 7 中，可以通过执行以下操作之一访问 Microsoft iSCSI initiator 的界面：</p>
<ul>
<li>依次单击『开始』、『控制面板』，在搜索字段中键入 iSCSI，然后在『管理工具』中单击『iSCSI initiator』。</li>
</ul>
<p><strong>发现目标</strong></p>
<ul>
<li>点击程序的发现页面，然后点击『发现门户&hellip;』。</li>
<li>在弹出的窗口中，可以输入服务器地址。</li>
<li>然后转到目标器页面，这是会自动显示服务器的所有有效 target。</li>
</ul>
<p><strong>登录到目标</strong></p>
<p>转到目标器页面，选中之前创建的目标，然后，点击连接。</p>
<blockquote>
<p>注解</p>
<p>默认勾选“将此连接添加到收藏目标列表”，意思就是，系统启动会自动连接存储设备。</p>
</blockquote>
<p>点击确定，就能够连接，然后我们就可以像操作普通磁盘一样，对其格式化，分区等等。</p>
<h2 id="公网访问-virtual-san">公网访问 Virtual SAN</h2>
<p>由于通过公网访问 Virtual SAN 的 IO 延迟比较大，通常情况下不建议以这种方式访问。 如果你有一些特殊的场景需要公网访问，除了按照前面的指南操作之外，还需要修改客户端的配置文件。</p>
<pre tabindex="0"><code>vi /var/lib/iscsi/nodes/&lt;目标IQN&gt;/&lt;Virtual SAN 服务器IP&gt;/default
</code></pre><p>在该文件里把node.conn[0].address从私网 IP 改成公网 IP 即可。</p>
<h2 id="部署-oracle-rac">部署 Oracle RAC</h2>
<p>亿栖云提供的 Virtual SAN 比较典型的应用场景就是 Oracle RAC。以下介绍如何在亿栖云上部署这样的服务。</p>
<h3 id="oracle-rac-部署拓扑">Oracle RAC 部署拓扑</h3>
<p>一个典型的 Oracle RAC 由多个数据库节点和共享硬盘组成。DB 客户端使用 scan-cluster 域名访问数据，负载均衡由 Oracle 自己控制。</p>
<p><img src="../_images/oracle_rac_topo.png" alt=""></p>
<h3 id="安装前准备">安装前准备</h3>
<p><strong>云服务器</strong></p>
<ul>
<li>基于 Oracle Linux 6.6 镜像</li>
<li>其中两台（node1, node2）作为 oracle 数据库节点，至少2核8G</li>
<li>加入连接了路由器的私有网络</li>
</ul>
<blockquote>
<p>注解</p>
<p>本文为了简化部署拓扑，只使用两个节点。请根据自己的项目需求决定数据库节点数量。</p>
</blockquote>
<p><strong>性能型硬盘</strong></p>
<ul>
<li>4块通过 Virtual SAN 提供共享存储, 用于部署数据库，具体大小看业务需求</li>
<li>1块用于存放安装文件，大小10G</li>
</ul>
<p><strong>Oracle 安装文件</strong></p>
<ul>
<li>
<p>本文档使用的安装文件具体如下：</p>
</li>
<li>
<p><a href="http://www.oracle.com/technetwork/database/enterprise-edition/downloads/database12c-linux-download-1959253.html">Oracle Database 12c Release 1 (12.1.0.1.0)</a></p>
</li>
<li>
<p><a href="http://www.oracle.com/technetwork/database/database-technologies/clusterware/downloads/index.html">Oracle Grid Infrastructure 12c Release 1 (12.1.0.1.0)</a></p>
</li>
</ul>
<h3 id="网络配置">网络配置</h3>
<p>Oracle RAC 需要云服务器加入两个网络，分别用于对外提供服务，和对内数据同步。在亿栖云可以让云服务器同时加入受管，和自管私有网络来满足这个要求。</p>
<p><strong>网络规划</strong></p>
<table>
<thead>
<tr>
<th>节点</th>
<th>受管网络地址</th>
<th>自管网络地址</th>
<th>VIP</th>
</tr>
</thead>
<tbody>
<tr>
<td>node1</td>
<td>192.168.100.2</td>
<td>172.16.100.2</td>
<td>192.168.100.102</td>
</tr>
<tr>
<td>node2</td>
<td>192.168.100.3</td>
<td>172.16.100.3</td>
<td>192.168.100.103</td>
</tr>
<tr>
<td>scan-cluster IP</td>
<td>192.168.100.210</td>
<td>n/a</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<p>其中scan-cluster IP 并不是云服务器，只是一个配置了 DNS 域名解析的 IP 地址，作用类似 VIP。在这个例子里面，我们把 Oracle RAC 的域名定为“scan-cluster.localdomain”, 您需要把它替换成适合自己的名字。</p>
<p>由于需要预留一些 IP 段，请修改路由器 DHCP 配置，减少自动分配的 IP 段。具体操作是:</p>
<ol>
<li>打开亿栖云路由器</li>
<li>点击“关闭DHCP服务”，并再次启动</li>
<li>弹出对话框如图。把254改成100, 然后提交</li>
</ol>
<p><img src="../_images/oracle_rac_dhcp.png" alt=""></p>
<blockquote>
<p>注解</p>
<p>这里推荐修改 DHCP 服务范围为2~100是为了方便配置数据库节点的 VIP, 比如 192.168.100.3对应的 VIP 可以是192.168.100.103。</p>
</blockquote>
<p><strong>配置云服务器网络和地址</strong></p>
<p>用户需要在亿栖云中做如下操作:</p>
<ol>
<li>云服务器 node1 和 node2 加入连接了路由器的受管私有网络（通常这一步创建云服务器时已经完成)</li>
<li>点击私有网络–创建， 在对话框中点击高级选项 ，选择“自管”，创建一个新的自管网络</li>
<li>右击私有网络–添加云服务器。把两个云服务器加到自管网络中</li>
</ol>
<p>加入所需的网络后，需要到云服务器的桌面上配置下自管网络的 IP 地址</p>
<p><img src="../_images/oracle_rac_private_ip.png" alt=""></p>
<blockquote>
<p>注解</p>
<ol>
<li>Oracle Linux自带的 NetworkManage 会覆盖命令行对 IP 地址的修改，最好使用桌面配置 IP。</li>
<li>截图里面172.16.100.1这个地址实际不存在，只是为了让配置有效。</li>
<li>先加入受管网络，再加入自管网络。这是为了让自管网络对应网卡成为 eth1, 这样默认网关就是 eth0 对应的网关，也就是受管网络路由器。</li>
</ol>
</blockquote>
<p><strong>配置私网 DNS 域名</strong></p>
<p>Oracle RAC 对外提供的地址是 scan-cluster 域名，Oracle 会管理 scan-cluster IP 地址，但是要求它能被 DNS 解析。亿栖云路由器提供了私网 DNS 功能，可以方便地在私网里面定义 DNS 记录，用于配置 scan-cluster 域名。</p>
<p>启动私网DNS，并为scan-cluster和每个节点定义私网域名。</p>
<p><img src="../_images/oracle_rac_enable_dns.png" alt=""></p>
<blockquote>
<p>注解</p>
<p>其中i-xjrahmmp和i-bxjv3vop是node1和node2的机器名。如果需要用自定义的机器名，请使用 <a href="#id7">*</a>.localdomain的格式，比如: node1.localdomain</p>
</blockquote>
<p>应用路由器修改后，如果是第一次启用私网 DNS 功能，需要等待一会儿，或者重启 network-manager 服务，让云服务器从 DHCP 更新 DNS 服务器 IP 地址，然后到node1/node2上面测试 DNS 记录是否可用:</p>
<pre tabindex="0"><code># yum install bind-utils -y
# nslookup 192.168.100.210
Server:               192.168.100.200#53
Address:      192.168.100.200#53

210.100.168.192.in-addr.arpa  name = scan-cluster.localdomain.

# nslookup scan-cluster.localdomain
Server:               192.168.100.200
Address:      192.168.100.200#53

Name: scan-cluster.localdomain
Address: 192.168.100.210
</code></pre><p><strong>修改/etc/hosts</strong></p>
<p>Grid安装包会从 <code>/etc/hosts</code> 里面找当前节点名字，在 <code>/etc/hosts</code> 文件的 <code>127.0.0.1</code> 这一行结尾添加云服务器名字，比如<code>i-xjrahmmp i-xjrahmmp.localdomain</code> 修改后，内容如下：</p>
<pre tabindex="0"><code># cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4 i-xjrahmmp i-xjrahmmp.localdomain
</code></pre><h3 id="创建用户修改用户配置文件">创建用户、修改用户配置文件</h3>
<p><strong>配置用户</strong> 配置 RAC 的时候需要安装 Oracle grid infrastructure、Oracle 数据库软件、其中 grid 是一个集群件，需要共享存储。oracle建议以不同的用户分别安装 grid 和数据库软件，这里以 grid 用户安装 grid 软件、oracle 用户安装 oracle 数据库软件。并且 grid、oracle 用户需要属于不同的用户组。在配置 rac 时，还要求这两个用户在不同的节点上 uid、gid 要一致。</p>
<p>在两个节点分别运行以下命令:</p>
<pre tabindex="0"><code>GRID_PW=grid
ORACLE_PW=oracle
groupadd -g 1000 oinstall
groupadd -g 1200 asmadmin
groupadd -g 1201 asmdba
groupadd -g 1202 asmoper
useradd -u 1100 -g oinstall -G asmadmin,asmdba,asmoper -d /home/grid -s /bin/bash -c &#34;grid Infrastructure Owner&#34; grid
echo &#34;$GRID_PW&#34; | passwd --stdin grid

echo &#39;export PS1=&#34;`/bin/hostname -s`-&gt; &#34;&#39;&gt;&gt; /home/grid/.bash_profile
echo &#34;export TMP=/tmp&#34;&gt;&gt; /home/grid/.bash_profile
echo &#39;export TMPDIR=$TMP&#39;&gt;&gt;/home/grid/.bash_profile
echo &#34;export ORACLE_SID=+ASM1&#34;&gt;&gt; /home/grid/.bash_profile
echo &#34;export ORACLE_BASE=/u01/app/grid&#34;&gt;&gt; /home/grid/.bash_profile
echo &#34;export ORACLE_HOME=/u01/app/11.2.0/grid&#34;&gt;&gt; /home/grid/.bash_profile
echo &#34;export ORACLE_TERM=xterm&#34;&gt;&gt; /home/grid/.bash_profile
echo &#34;export NLS_DATE_FORMAT=&#39;yyyy/mm/dd hh24:mi:ss&#39;&#34; &gt;&gt; /home/grid/.bash_profile
echo &#39;export TNS_ADMIN=$ORACLE_HOME/network/admin&#39;  &gt;&gt; /home/grid/.bash_profile
echo &#39;export PATH=/usr/sbin:$PATH&#39;&gt;&gt; /home/grid/.bash_profile
echo &#39;export PATH=$ORACLE_HOME/bin:$PATH&#39;&gt;&gt; /home/grid/.bash_profile
echo &#39;export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib&#39;&gt;&gt; /home/grid/.bash_profile
echo &#39;export CLASSPATH=$ORACLE_HOME/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib&#39;&gt;&gt; /home/grid/.bash_profile
echo &#34;export EDITOR=vi&#34; &gt;&gt; /home/grid/.bash_profile
echo &#34;export LANG=en_US&#34; &gt;&gt; /home/grid/.bash_profile
echo &#34;export NLS_LANG=american_america.AL32UTF8&#34; &gt;&gt; /home/grid/.bash_profile
echo &#34;umask 022&#34;&gt;&gt; /home/grid/.bash_profile

groupadd -g 1300 dba
groupadd -g 1301 oper
useradd -u 1101 -g oinstall -G dba,oper,asmdba -d /home/oracle -s /bin/bash -c &#34;Oracle Software Owner&#34; oracle
echo &#34;$ORACLE_PW&#34; | passwd --stdin oracle

echo &#39;export PS1=&#34;`/bin/hostname -s`-&gt; &#34;&#39;&gt;&gt; /home/oracle/.bash_profile
echo &#34;export TMP=/tmp&#34;&gt;&gt; /home/oracle/.bash_profile
echo &#39;export TMPDIR=$TMP&#39;&gt;&gt;/home/oracle/.bash_profile
echo &#34;export ORACLE_HOSTNAME=node1.localdomain&#34;&gt;&gt; /home/oracle/.bash_profile
echo &#34;export ORACLE_SID=devdb1&#34;&gt;&gt; /home/oracle/.bash_profile
echo &#34;export ORACLE_BASE=/u01/app/oracle&#34;&gt;&gt; /home/oracle/.bash_profile
echo &#39;export ORACLE_HOME=$ORACLE_BASE/product/11.2.0/db_1&#39;&gt;&gt; /home/oracle/.bash_profile
echo &#34;export ORACLE_UNQNAME=devdb&#34;&gt;&gt; /home/oracle/.bash_profile
echo &#39;export TNS_ADMIN=$ORACLE_HOME/network/admin&#39;  &gt;&gt; /home/oracle/.bash_profile
echo &#34;export ORACLE_TERM=xterm&#34;&gt;&gt; /home/oracle/.bash_profile
echo &#39;export PATH=/usr/sbin:$PATH&#39;&gt;&gt; /home/oracle/.bash_profile
echo &#39;export PATH=$ORACLE_HOME/bin:$PATH&#39;&gt;&gt; /home/oracle/.bash_profile
echo &#39;export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib&#39;&gt;&gt; /home/oracle/.bash_profile
echo &#39;export CLASSPATH=$ORACLE_HOME/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib&#39;&gt;&gt; /home/oracle/.bash_profile
echo &#34;export EDITOR=vi&#34; &gt;&gt; /home/oracle/.bash_profile
echo &#34;export LANG=en_US&#34; &gt;&gt; /home/oracle/.bash_profile
echo &#34;export NLS_LANG=american_america.AL32UTF8&#34; &gt;&gt; /home/oracle/.bash_profile
echo &#34;export NLS_DATE_FORMAT=&#39;yyyy/mm/dd hh24:mi:ss&#39;&#34; &gt;&gt; /home/oracle/.bash_profile
echo &#34;umask 022&#34;&gt;&gt; /home/oracle/.bash_profile
id grid
id oracle
</code></pre><blockquote>
<p>注解</p>
<p>生成环境请修改代码中的密码。</p>
</blockquote>
<p>脚本执行后会输出 uid/gid, 请比较两个节点，看是否如下：</p>
<pre tabindex="0"><code>uid=1100(grid) gid=1000(oinstall) groups=1000(oinstall),1200(asmadmin),1201(asmdba),1202(asmoper)
uid=1101(oracle) gid=1000(oinstall) groups=1000(oinstall),1201(asmdba),1300(dba),1301(oper)
</code></pre><p><strong>创建软件安装目录、改权限</strong></p>
<p>在两个节点分别运行以下命令</p>
<pre tabindex="0"><code>mkdir -p /u01/app/grid
mkdir -p /u01/app/11.2.0/grid
mkdir -p /u01/app/oracle
chown -R oracle:oinstall /u01
chown -R grid:oinstall /u01/app/grid
chown -R grid:oinstall /u01/app/11.2.0
chmod -R 775 /u01
</code></pre><p><strong>修改/etc/security/limits.conf</strong></p>
<p>在两个节点分别运行以下命令</p>
<pre tabindex="0"><code>cp /etc/security/limits.conf /etc/security/limits.conf.bak
echo &#34;oracle soft nproc 2047&#34; &gt;&gt;/etc/security/limits.conf
echo &#34;oracle hard nproc 16384&#34; &gt;&gt;/etc/security/limits.conf
echo &#34;oracle soft nofile 1024&#34; &gt;&gt;/etc/security/limits.conf
echo &#34;oracle hard nofile 65536&#34; &gt;&gt;/etc/security/limits.conf
echo &#34;grid soft nproc 2047&#34; &gt;&gt;/etc/security/limits.conf
echo &#34;grid hard nproc 16384&#34; &gt;&gt;/etc/security/limits.conf
echo &#34;grid soft nofile 1024&#34; &gt;&gt;/etc/security/limits.conf
echo &#34;grid hard nofile 65536&#34; &gt;&gt;/etc/security/limits.conf
</code></pre><p><strong>修改 /etc/pam.d/login 配置文件</strong></p>
<p>在两个节点分别运行以下命令</p>
<pre tabindex="0"><code>cp /etc/pam.d/login /etc/pam.d/login.bak
echo &#34;session required /lib/security/pam_limits.so&#34; &gt;&gt;/etc/pam.d/login
echo &#34;session required pam_limits.so&#34; &gt;&gt;/etc/pam.d/login
</code></pre><p><strong>修改 /etc/profile文件</strong></p>
<p>在两个节点分别运行以下命令</p>
<pre tabindex="0"><code>cp /etc/profile /etc/profile.bak
echo &#39;if [ $USER = &#34;oracle&#34; ]||[ $USER = &#34;grid&#34; ]; then&#39; &gt;&gt;  /etc/profile
echo &#39;if [ $SHELL = &#34;/bin/ksh&#34; ]; then&#39; &gt;&gt; /etc/profile
echo &#39;ulimit -p 16384&#39; &gt;&gt; /etc/profile
echo &#39;ulimit -n 65536&#39; &gt;&gt; /etc/profile
echo &#39;else&#39; &gt;&gt; /etc/profile
echo &#39;ulimit -u 16384 -n 65536&#39; &gt;&gt; /etc/profile
echo &#39;fi&#39; &gt;&gt; /etc/profile
echo &#39;fi&#39; &gt;&gt; /etc/profile
</code></pre><p><strong>修改内核配置文件</strong></p>
<p>在两个节点分别运行以下命令</p>
<pre tabindex="0"><code>cp /etc/sysctl.conf /etc/sysctl.conf.bak
echo &#34;fs.aio-max-nr = 1048576&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;fs.file-max = 6815744&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;kernel.shmall = 2097152&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;kernel.shmmax = 1054472192&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;kernel.shmmni = 4096&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;kernel.sem = 250 32000 100 128&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;net.ipv4.ip_local_port_range = 9000 65500&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;net.core.rmem_default = 262144&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;net.core.rmem_max = 4194304&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;net.core.wmem_default = 262144&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;net.core.wmem_max = 1048586&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;net.ipv4.tcp_wmem = 262144 262144 262144&#34; &gt;&gt; /etc/sysctl.conf
echo &#34;net.ipv4.tcp_rmem = 4194304 4194304 4194304&#34; &gt;&gt; /etc/sysctl.conf
sysctl -p
</code></pre><p><strong>停止 NTP 服务，否则安装的时候检查环境会通不过</strong></p>
<p>在两个节点分别运行以下命令</p>
<pre tabindex="0"><code>service ntpd stop
chkconfig ntpd off
rm -f /etc/ntp.conf
</code></pre><p><strong>配置 oracle grid 用户 ssh 的对等性</strong></p>
<p>就是在grid和oracle用户下创建密钥，上传公钥，两个用户的节点间互访都不需要密码，具体操作自行处理。 请分别以grid和oracle用户运行下面命令：</p>
<pre tabindex="0"><code>sed -i &#39;s/UserKnownHostsFile \/dev\/null//g&#39; /etc/ssh/ssh_config
sed -i &#39;s/StrictHostKeyChecking no/StrictHostKeyChecking ask/g&#39; /etc/ssh/ssh_config
ssh-keygen -N &#34;&#34; -f ~/.ssh/id_rsa
ssh-keygen -N &#34;&#34; -y -f ~/.ssh/id_rsa &gt; ~/.ssh/id_rsa.pub
cat ~/.ssh/id_rsa.pub
</code></pre><p>这里需要手动把生成的公钥都加到node1/node2的～/.ssh/authorized_keys里面，再分别到node1和node2以grid和oracle用户执行下面命令:</p>
<pre tabindex="0"><code>INSTANCE_ID_NODE1=i-xjrahmmp
INSTANCE_ID_NODE2=i-bxjv3vop
ssh $INSTANCE_ID_NODE1 date
ssh $INSTANCE_ID_NODE2 date
ssh $INSTANCE_ID_NODE1.localdomain date
ssh $INSTANCE_ID_NODE2.localdomain date
ssh node1-priv date
ssh node2-priv date
ssh node1-priv.localdomain date
ssh node2-priv.localdomain date
</code></pre><blockquote>
<p>注解</p>
<p>请替换里面的<code>i-xjrahmmp</code>和<code>i-bxjv3vop</code>为node1|node2的云服务器id。node1除了信任node2, 还要信任自己，反之也是。请多次运行以上命令，直到能正确返回时间，并且不再提示“RSA key fingerprint&hellip;Are you sure you want&hellip;”</p>
</blockquote>
<h3 id="存储配置">存储配置</h3>
<p>本例共需要5块性能型硬盘，1块本地硬盘用于存储数据库安装文件，4块共享存储。对应本地硬盘，请挂载到node1上面，并拷贝和解压安装文件。</p>
<blockquote>
<p>注解</p>
<p>对于您具体需要多少块共享硬盘，和具体的大小，请咨询 dba</p>
</blockquote>
<p>创建并挂载共享存储，请参考 <a href="#guide-s2"><em>Virtual SAN 指南</em></a> 。将 4 块硬盘全部加载到 node1 和 node2 ， 然后把那块本地硬盘挂到 node1。挂完之后，node1 应该是这样子(其中 vdc 是本地硬盘):</p>
<pre tabindex="0"><code># lsblk
NAME   MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
sda      8:0    0  10G  0 disk
sdb      8:16   0  10G  0 disk
sdc      8:32   0  10G  0 disk
sdd      8:48   0  10G  0 disk
vda    251:0    0  20G  0 disk
└─vda1 251:1    0  20G  0 part /
vdb    251:16   0   8G  0 disk [SWAP]
vdc    251:32   0  10G  0 disk
└─vdc1 251:33   0  10G  0 part
</code></pre><p>运行下面命令创建配置文件<code>99-oracle-asmdevices.rules</code></p>
<pre tabindex="0"><code>echo &#34;options=--whitelisted --replace-whitespace&#34;&gt;/etc/scsi_id.config
rm -f /etc/udev/rules.d/99-oracle-asmdevices.rules
i=1
id=&#39;&#39;
for x in a b c d
  do
    id=`scsi_id --whitelisted --replace-whitespace --device=/dev/sd$x`
    echo &#34;KERNEL==\&#34;sd*\&#34;, SUBSYSTEM==\&#34;block\&#34;, PROGRAM==\&#34;/sbin/scsi_id --whitelisted --replace-whitespace --device=/dev/\$name\&#34;, RESULT==\&#34;$id\&#34;, NAME=\&#34;asm-disk$i\&#34;,  OWNER=\&#34;grid\&#34;,  GROUP=\&#34;asmadmin\&#34;, MODE=\&#34;0660\&#34;&#34;&gt;&gt;/etc/udev/rules.d/99-oracle-asmdevices.rules
    let i++
  done
/sbin/start_udev
</code></pre><blockquote>
<p>注解</p>
<p>以上代码中，”a b c d”代表加载的共享硬盘 sda~sdd 。请根据实际情况修改。硬盘必须是新硬盘（无分区，没有被格式化），否则 Grid 无法安装。</p>
</blockquote>
<p>检查udev是否正常配置</p>
<pre tabindex="0"><code># ll /dev/asm*
brw-rw---- 1 grid asmadmin 8, 48 3月  12 21:15 /dev/asm-disk1
brw-rw---- 1 grid asmadmin 8, 16 3月  12 21:20 /dev/asm-disk2
brw-rw---- 1 grid asmadmin 8, 32 3月  12 21:20 /dev/asm-disk3
brw-rw---- 1 grid asmadmin 8, 48 3月  12 21:20 /dev/asm-disk4
</code></pre><p>安装依赖包</p>
<pre tabindex="0"><code>yum install -y sysstat libstdc++-devel libaio-devel gcc-c++ compat-libstdc++-33 elfutils-libelf-devel smartmontools compat-libcap1 ksh nfs-utils
</code></pre><p>到这里，环境准备结束，可以开始安装软件了。</p>
<h3 id="安装-oracle-软件">安装 Oracle 软件</h3>
<p>请把安装文件下载并解压到 node1的/mnt/vdc 目录。应该是这个样子：</p>
<pre tabindex="0"><code>[root@i-xjrahmmp vdc]# ll
total 4531520
drwxr-xr-x 7 root root       4096 7月   7 2014 database
drwxr-xr-x 7 root root       4096 6月  10 2013 grid
-rw-r--r-- 1 root root 1361028723 3月  12 11:51 linuxamd64_12c_database_1of2.zip
-rw-r--r-- 1 root root 1116527103 3月  12 11:37 linuxamd64_12c_database_2of2.zip
-rw-r--r-- 1 root root 1750478910 3月  11 19:52 linuxamd64_12c_grid_1of2.zip
-rw-r--r-- 1 root root  201673595 3月  11 19:52 linuxamd64_12c_grid_2of2.zip
drwx------ 2 root root      16384 3月  11 19:38 lost+found
</code></pre><p><strong>安装前预检查配置信息</strong></p>
<p>oracle grid infrastructure 提供了一个脚本，检查，并修复环境问题。请在 node1 执行下面命令（请替换 i-xjrahmmp,i-bxjv3vop 为实际用的 instance id ）:</p>
<pre tabindex="0"><code>su - grid
cd /mnt/vdc/grid
./runcluvfy.sh stage -pre crsinst -n i-xjrahmmp,i-bxjv3vop -fixup -verbose
</code></pre><p>通常会检查出一些问题，oracle 自动会给我们提供修复脚本，例如修复用户组，内核参数什么的。第一次运行会提示：</p>
<pre tabindex="0"><code>Press ENTER key to continue after execution of &#34;/tmp/CVU_12.1.0.1.0_grid/runfixup.sh&#34; has completed on nodes &#34;i-xjrahmmp,i-bxjv3vop&#34;
</code></pre><p>表示需要以 root 用户在节点” i-xjrahmmp,i-bxjv3vop” 上面运行 /tmp/CVU_12.1.0.1.0_grid/runfixup.sh。 运行完成后，回到这个 terminal, 按回车键。</p>
<p>修复完后再次检查，如果还是有问题，请自己查看是否有 fail 的地方，并自行解决。如果执行了本文提供的所有操作，是不会有问题的。</p>
<p><strong>安装 Grid Infrastructure</strong></p>
<p>从此步骤开始正式安装 Grid 软件，请使用亿栖云的 web terminal 登录 node1 的桌面，执行以下安装步骤。</p>
<p>以 grid 用户登录图形界面，执行 “grid/runInstaller”进入 OUI 图形安装界面。请按以下截图选择:</p>
<p><img src="../_images/grid1.png" alt="">
<img src="../_images/grid2.png" alt="">
<img src="../_images/grid3.png" alt="">
<img src="../_images/grid4.png" alt="">
<img src="../_images/grid5.png" alt=""></p>
<p>由于 Grid安装包从/etc/hosts 中读取本地节点 (Local node) 名字，跟系统设置可能不匹配。如果提示 [INS-40907] Local node not included in the list of host names for grid installation 错误，请检查是否完成了本文“修改 /etc/hosts” 一节所需的配置。</p>
<p><img src="../_images/grid6.png" alt="">
<img src="../_images/grid7.png" alt="">
<img src="../_images/grid8.png" alt="">
<img src="../_images/grid9.png" alt="">
<img src="../_images/grid10.png" alt=""></p>
<p>如果 VSAN 挂载的硬盘已经被分区或者格式化，Grid 安装包会忽略所有 VSAN 的硬盘，导致硬盘列表里面不显示硬盘。请确保挂载的硬盘都是新硬盘。</p>
<p><img src="../_images/grid11.png" alt="">
<img src="../_images/grid12.png" alt="">
<img src="../_images/grid13.png" alt="">
<img src="../_images/grid14.png" alt="">
<img src="../_images/grid15.png" alt="">
<img src="../_images/grid16.png" alt=""></p>
<p>这一步会再次检查环境。会发现两个问题，点 “fix &amp; check again”按钮，会得到提示，在两个节点上面用 root 运行一个脚本。请按提示执行，然后重新检查环境。</p>
<p><img src="../_images/grid17.png" alt=""></p>
<blockquote>
<p>注解</p>
<p>grid 安装环境检查脚本在 Oracle Linux 6 上面的一个 bug 导致错误” PRVF-9802” 无法解决，具体原因请见 <a href="http://www.hhutzler.de/blog/debug-cluvfy-error-error-prvf-9802/">Debug Cluvfy error ERROR: PRVF-9802</a> 。</p>
</blockquote>
<p>为了继续安装，请勾上”Ingore All”忽略这个错误，然后下一步。</p>
<p><img src="../_images/grid18.png" alt=""></p>
<p>安装到 79% 时，会提示以root用户到两个节点运行脚本。这里必须从 node1 开始执行，全部执行完了，然后再去 node2 执行。其中第二个脚本需要十多分钟的时间执行。</p>
<p><img src="../_images/grid19.png" alt=""></p>
<p>脚本执行完成后，到安装界面继续，并完成安装。安装完成后，以 grid 用户运行下面命令确认集群已启动</p>
<pre tabindex="0"><code>-&gt; crs_stat -t
Name           Type           Target    State     Host
------------------------------------------------------------
ora....SM.lsnr ora....er.type ONLINE    ONLINE    i-bxjv3vop
ora.DATA.dg    ora....up.type ONLINE    ONLINE    i-xjrahmmp
ora....ER.lsnr ora....er.type ONLINE    ONLINE    i-bxjv3vop
ora....N1.lsnr ora....er.type ONLINE    ONLINE    i-xjrahmmp
ora.MGMTLSNR   ora....nr.type ONLINE    ONLINE    i-xjrahmmp
ora.asm        ora.asm.type   ONLINE    ONLINE    i-xjrahmmp
ora.cvu        ora.cvu.type   ONLINE    ONLINE    i-xjrahmmp
ora....OP.lsnr application    ONLINE    ONLINE    i-bxjv3vop
ora....vop.ons application    ONLINE    ONLINE    i-bxjv3vop
ora....vop.vip ora....t1.type ONLINE    ONLINE    i-bxjv3vop
ora....MP.lsnr application    ONLINE    ONLINE    i-xjrahmmp
ora....mmp.ons application    ONLINE    ONLINE    i-xjrahmmp
ora....mmp.vip ora....t1.type ONLINE    ONLINE    i-xjrahmmp
ora.mgmtdb     ora....db.type ONLINE    ONLINE    i-xjrahmmp
ora....network ora....rk.type ONLINE    ONLINE    i-bxjv3vop
ora.oc4j       ora.oc4j.type  ONLINE    ONLINE    i-xjrahmmp
ora.ons        ora.ons.type   ONLINE    ONLINE    i-bxjv3vop
ora.proxy_advm ora....vm.type ONLINE    OFFLINE
ora.scan1.vip  ora....ip.type ONLINE    ONLINE    i-xjrahmmp
</code></pre><blockquote>
<p>注解</p>
<p>在 12c 版本中， ora.proxy_advm 被用到时才会启动，所以安装完显示为 OFFLINE ,并不代表出了问题。</p>
</blockquote>
<p><strong>安装 oracle 数据库软件</strong></p>
<p>以 oracle 用户登录，执行 database/runInstaller 进入图形安装界面。</p>
<p><img src="../_images/db1.png" alt="">
<img src="../_images/db2.png" alt="">
<img src="../_images/db3.png" alt="">
<img src="../_images/db4.png" alt="">
<img src="../_images/db5.png" alt="">
<img src="../_images/db6.png" alt=""></p>
<p>然后开始安装，最后也会提示用 root 用户身份在两个节点执行脚本，执行完后结束安装。</p>
<p><strong>创建 asm 磁盘组</strong></p>
<p>以 grid 用户创建 asm 磁盘组，创建的磁盘组为 Oracle 数据库提供存储。</p>
<ol>
<li>以 grid 用户登录图形界面，执行 asmca</li>
<li>Disk Groups ,Create 创建新的磁盘组</li>
<li>输入名称G1，冗余选external，磁盘选择asm-disk3，ok</li>
<li>继续创建磁盘组，名称FLASH，冗余选external，磁盘选asm-disk4，ok （这个创建的是闪回恢复区-Flash Recovery Area，大小问DBA如何规划）</li>
<li>至此，3个磁盘组全部被RAC mount</li>
</ol>
<p><strong>创建 rac 数据库</strong></p>
<p>以 oracle 用户登录图形界面，执行 dbca ，进入 DBCA 图形界面</p>
<p><img src="../_images/create_db1.png" alt="">
<img src="../_images/create_db2.png" alt="">
<img src="../_images/create_db3.png" alt="">
<img src="../_images/create_db4.png" alt="">
<img src="../_images/create_db5.png" alt="">
<img src="../_images/create_db6.png" alt="">
<img src="../_images/create_db7.png" alt="">
<img src="../_images/create_db8.png" alt=""></p>
<p>下一步选中创建 sample schema ， 然后后面几步全部默认，完成数据库创建。</p>
<p><strong>测试数据库是否正常</strong></p>
<p>使用 oracle 用户运行 sqlplus 就能连接数据库。输入用户名（system）和安装时定义的密码后，应该能进入 sql terminal 。可以试一下能否运行 sql 语句</p>
<pre tabindex="0"><code>SQL&gt; CREATE TABLE users;
(
    user_id varchar(255) PRIMARY KEY NOT NULL,
    user_name varchar(255) NOT NULL
);  2    3    4    5

Table created.
SQL&gt; drop table users;

Table dropped.
</code></pre>
	
	
	<div class="page-meta-pagination border-top">
		
		<a href="/storage/share/manual/neonsan_volume/" class="prev pl1" title="企业级分布式 SAN ">
			上一页: 企业级分布式 SAN
		</a>
		

		
	</div>
	<div class="page-meta-pagination_word">
		这篇文档解决了您的问题吗？
		<div class="doc_fix_click fix-background-like" data-flag='1'>
			<span>0</span>
		</div>
		<div class="doc_fix_click fix-background-unlike" data-flag='0'>
			<span>0</span>
		</div>
		<input type="hidden" id="doc_fix_flag" value="0">
	</div>
</div>
<script src="/js/content.js"></script>
<script src="/js/viewer.min.js"></script>
<link rel="stylesheet" href="/css/viewer.min.css">
<script>
	var viewer = new Viewer(document.querySelector('.td-content'), {
		url: 'src'
	})
</script>

          </main>
        </div>
      </div>
    </div>
         
    
<script src="/css/bootstrap.min.js"></script>
<script src="/js/autocomplete/jquery.autocomplete.js"></script>
<script src="/js/navbar.js"></script>
<script src="/js/copy-to-clipboard.js"></script>
</script>






<script src="/js/main.min.7d5b92c4889cf0554b0ea5e2309b0b81b196aa7c9a235632938a25d9fc4d8a7c.js" integrity="sha256-fVuSxIic8FVLDqXiMJsLgbGWqnyaI1Yyk4ol2fxNinw=" crossorigin="anonymous"></script>



  </body>
</html>